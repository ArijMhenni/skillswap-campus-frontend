@if (isLoading()) {
  <div class="container mx-auto p-6 text-center">
    <p>Loading...</p>
  </div>
}

@if (!isLoading() && request()) {
  <div class="container mx-auto p-6 max-w-4xl">
    <button
      (click)="goBack()"
      class="mb-6 text-blue-600 hover:text-blue-800">
      ‚Üê Back
    </button>

    <div class="bg-white rounded-lg shadow-lg p-8">
      <!-- Header -->
      <div class="flex justify-between items-start mb-6">
        <h1 class="text-3xl font-bold">{{ request()!.skill?.title }}</h1>
        <span [class]="request()!.status | statusColor" class="px-4 py-2 rounded-full text-sm font-semibold">
          {{ request()!.status }}
        </span>
      </div>

      <!-- Skill Details -->
      <div class="mb-6 p-4 bg-gray-50 rounded-lg">
        <h2 class="font-semibold mb-2">Requested Skill:</h2>
        <p class="text-gray-700">{{ request()!.skill?.description }}</p>
        <div class="mt-2">
          <span class="inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm">
            {{ request()!.skill?.category }}
          </span>
        </div>
      </div>

      <!-- Users -->
      <div class="grid md:grid-cols-2 gap-6 mb-6">
        <div class="p-4 border rounded-lg">
          <h3 class="font-semibold mb-2">Requester:</h3>
          <p>{{ request()!.requester?.firstName }} {{ request()!.requester?.lastName }}</p>
          <p class="text-sm text-gray-600">{{ request()!.requester?.email }}</p>
        </div>

        <div class="p-4 border rounded-lg">
          <h3 class="font-semibold mb-2">Provider:</h3>
          <p>{{ request()!.provider?.firstName }} {{ request()!.provider?.lastName }}</p>
          <p class="text-sm text-gray-600">{{ request()!.provider?.email }}</p>
        </div>
      </div>

      <!-- Message -->
      <div class="mb-6 p-4 bg-blue-50 rounded-lg">
        <h3 class="font-semibold mb-2">Message:</h3>
        <p>{{ request()!.message }}</p>
      </div>

      <!-- Date -->
      <p class="text-sm text-gray-600 mb-6">
        Created on {{ request()!.createdAt | date:'dd/MM/yyyy at HH:mm' }}
      </p>

      <!-- Actions -->
      <div class="flex gap-3 flex-wrap">
        @if (request()!.status === RequestStatus.PENDING && isProvider()) {
          <button
            (click)="updateStatus(RequestStatus.ACCEPTED)"
            class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700">
            Accept
          </button>
          <button
            (click)="updateStatus(RequestStatus.REJECTED)"
            class="px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700">
            Reject
          </button>
        }

        @if (request()!.status === RequestStatus.ACCEPTED) {
          <button
            (click)="updateStatus(RequestStatus.COMPLETED)"
            class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
            Mark as completed
          </button>
        }
      </div>
    </div>
  </div>
}