<div class="skill-list-container">
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">Place de Marché des Compétences</h1>
      <p class="page-subtitle">Découvrez les compétences à apprendre ou partagez votre expertise avec la communauté</p>
    </div>
    <button class="btn-create" (click)="createSkill()">
      <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="5" x2="12" y2="19"/>
        <line x1="5" y1="12" x2="19" y2="12"/>
      </svg>
      <span>Publier une Compétence</span>
    </button>
  </div>

  <div class="filters-section">
    <div class="search-container">
      <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"/>
        <path d="m21 21-4.35-4.35"/>
      </svg>
      <input
        type="text"
        placeholder="Rechercher des compétences..."
        [value]="filters().search || ''"
        (input)="onSearchChange($any($event.target).value)"
        class="search-input"
      />
    </div>

    <div class="filter-tabs">
      <button
        class="filter-tab"
        [class.active]="!filters().type"
        (click)="onTypeChange('')"
      >
        Tout
      </button>
      @for (t of types; track t) {
        <button
          class="filter-tab"
          [class.active]="filters().type === t"
          (click)="onTypeChange(t)"
        >
          {{ getTypeLabel(t) }}
        </button>
      }
    </div>

    <div class="category-filters">
      <button
        class="category-btn"
        [class.active]="!filters().category"
        (click)="onCategoryChange('')"
      >
        <span>Tout</span>
      </button>
      @for (cat of categories; track cat) {
        <button
          class="category-btn"
          [class.active]="filters().category === cat"
          (click)="onCategoryChange(cat)"
        >
          <span>{{ getCategoryLabel(cat) }}</span>
        </button>
      }
    </div>
  </div>

  @if (loading()) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Chargement...</p>
    </div>
  }

  @if (error() && !loading()) {
    <div class="error-state">
      <p class="error-message">{{ error() }}</p>
      <button class="btn-retry" (click)="loadSkills()">Réessayer</button>
    </div>
  }

  @if (!loading() && !error()) {
    <div class="results-header">
      <p class="results-count">Affichage de <strong>{{ skills().length }}</strong> compétences</p>
      <div class="sort-options">
        <span class="sort-label">Trier par:</span>
        <select class="sort-select">
          <option value="recent">Plus récent</option>
          <option value="popular">Plus populaire</option>
          <option value="rating">Mieux noté</option>
        </select>
      </div>
    </div>

    <div class="skills-grid">
      @for (skill of skills(); track skill.id) {
        <app-skill-card [skill]="skill" (click)="viewSkillDetail(skill.id)"></app-skill-card>
      } @empty {
        <div class="empty-state">
          <svg class="empty-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="12"/>
            <line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
          <p class="empty-message">Aucune compétence trouvée</p>
          <p class="empty-submessage">Essayez d'ajuster vos filtres ou créez une nouvelle compétence</p>
        </div>
      }
    </div>

    @if (pagination().totalPages > 1) {
      <div class="pagination">
        <button
          class="pagination-btn"
          [disabled]="pagination().page === 1"
          (click)="goToPage(pagination().page - 1)"
        >
          Précédent
        </button>
        <div class="pagination-pages">
          @for (page of [].constructor(pagination().totalPages); track $index) {
            <button
              class="pagination-page"
              [class.active]="pagination().page === $index + 1"
              (click)="goToPage($index + 1)"
            >
              {{ $index + 1 }}
            </button>
          }
        </div>
        <button
          class="pagination-btn"
          [disabled]="pagination().page === pagination().totalPages"
          (click)="goToPage(pagination().page + 1)"
        >
          Suivant
        </button>
      </div>
    }
  }
</div>
